{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Pr\u00e1ctica 4.1: Configuraci\u00f3n de un servidor DNS","text":""},{"location":"#introduccion","title":"Introducci\u00f3n","text":"<p>En esta pr\u00e1ctica se llevar\u00e1 a cabo la instalaci\u00f3n y configuraci\u00f3n del servidor de nombres bind9.</p> <p>Este tipo de servidores se encargan de resolver los nombres de dominio de las URL, actuando como un intermediario esencial. Su funci\u00f3n es clave, ya que permite que las direcciones URL sean m\u00e1s f\u00e1ciles de recordar, en lugar de utilizar direcciones num\u00e9ricas complejas para identificar una m\u00e1quina.</p>"},{"location":"#instalacion-de-bind9","title":"Instalaci\u00f3n de Bind9:","text":"<p>Nos conectamos mediante <code>SSH</code> a nuestro servidor usando el siguiente comando: </p> <p></p> <p>Primero actualizamos los paquetes de Debian:</p> <pre><code>    sudo apt update \n    sudo apt upgrade\n</code></pre> <p>Para instalar Bind9 en Debian 12, utilizaremos el gestor de  paquetes del sistema, ya que est\u00e1 disponible en los repositorios. El comando que debemos ejecutar es el siguiente:</p> <pre><code>    sudo apt-get install bind9 bind9utils bind9-doc\n</code></pre> <p></p> <p>Dado que en esta pr\u00e1ctica y para el servidor de pruebas no vamos a necesitar IPV6, podemos desactivarla modificando los par\u00e1metros de inicio del servicio named, que es el nombre del servidor Bind9.</p> <p>Para ello, debemos editar el archivo /etc/default/named y agregar el par\u00e1metro -4 al final de la variable OPTIONS, tal como se muestra en la captura.</p> <p></p>"},{"location":"#archivo-de-configuracion-principal","title":"Archivo de configuraci\u00f3n principal","text":"<p>Este archivo se encarga de agrupar los tres archivos de configuraci\u00f3n principales del servidor Bind9. Generalmente, no es necesario modificarlo, ya que su funci\u00f3n es incluir los diferentes archivos de configuraci\u00f3n, los cuales son:</p> <ul> <li>named.conf.options: Contiene las opciones generales del servidor Bind9.</li> <li>named.conf.local: Define las zonas del servidor Bind9.</li> <li>named.conf.default-zones: Contiene las zonas predeterminadas del servidor Bind9, como la de localhost y la de broadcast. Este archivo no ser\u00e1 modificado en esta pr\u00e1ctica.</li> </ul> <p></p>"},{"location":"#configuracion-general","title":"Configuraci\u00f3n general","text":"<p>Antes de definir las zonas, es necesario hacer algunos cambios en el archivo de configuraci\u00f3n general.</p>"},{"location":"#copia-de-seguridad","title":"Copia de seguridad","text":"<p>Siempre que se modifican archivos de configuraci\u00f3n, es recomendable guardar una copia de seguridad de la versi\u00f3n que funciona, por si necesitamos volver a ella. Esto se puede hacer con el siguiente comando:</p> <pre><code>sudo cp /etc/bind/named.conf.options /etc/bind/named.conf.options.backup\n</code></pre>"},{"location":"#lista-blanca-de-peticiones","title":"Lista blanca de peticiones","text":"<p>En esta pr\u00e1ctica, vamos a crear una lista blanca para permitir que solo ciertas redes puedan hacer consultas al servidor de nombres. Esto se hace usando el bloque acl, donde agregamos las direcciones de red permitidas junto con su m\u00e1scara de red abreviada. El formato del bloque es el siguiente:</p> <pre><code>acl \"&lt;nombreAcl&gt;\" {\n    &lt;byte&gt;.&lt;byte&gt;.&lt;byte&gt;.&lt;byte&gt;/&lt;m\u00e1scara&gt;;\n    //...\n};\n</code></pre> <p>En mi caso, lo he denominado trusted:</p> <p></p>"},{"location":"#configuracion-del-servidor","title":"Configuraci\u00f3n del servidor","text":"<p>La configuraci\u00f3n que vamos a hacer es la siguiente:</p> <ol> <li>Primero, desactivamos las peticiones con IPV6. Aunque ya lo hab\u00edamos hecho antes, tambi\u00e9n lo tenemos que configurar aqu\u00ed.</li> <li>Decimos que solo las redes de la lista blanca podr\u00e1n hacer consultas recursivas a otros DNS para resolver nombres. A\u00fan no les damos permiso para hacer estas consultas, solo indicamos qui\u00e9nes pueden hacerlo.</li> <li>Configuramos el servidor para que ning\u00fan equipo que haga una petici\u00f3n a nuestro DNS pueda ser redirigido a otra zona diferente de la que est\u00e1 usando.</li> <li>Establecemos que el servidor Bind9 escuche en la IP y el puerto que hemos indicado.</li> <li>Permitimos las consultas recursivas en Bind9.</li> </ol> <p></p> <p>Verificamos que toda la configuraci\u00f3n est\u00e9 correcta con el siguiente comando:</p> <pre><code>    sudo named-checkconf\n</code></pre> <p></p>"},{"location":"#zona-dns-principal","title":"Zona DNS principal","text":"<p>Para definir las zonas nos dirigimos al archivo named.conf.local, y en dicho archivo debemos de usar el bloque zone{...}; para definir las diferentes zonas. La sint\u00e1xis es la siguiente:</p> <pre><code>zone \"&lt;nombre_zona&gt;\" {\n    type master;\n    file \"&lt;ruta_archivo_zona&gt;\";\n}\n</code></pre> <p></p>"},{"location":"#archivo-de-zona","title":"Archivo de zona","text":"<p>A\u00f1adimos los registros correspondientes SOA, NS y un nuevo registro de tipo A. Este \u00faltimo indica que el subdominio \"debian\" se asociar\u00e1 con la IP que especifiquemos, y su sintaxis ser\u00e1 de la siguiente forma: <code>&lt;subdominio&gt; IN A &lt;ip&gt;</code>.</p> <p></p>"},{"location":"#zona-dns-inversa","title":"Zona DNS inversa","text":"<p>Para configurar la zona inversa, debemos usar una sintaxis especial que le indique al servidor DNS que esa zona se utilizar\u00e1 para resolver direcciones IP a nombres de dominio.</p> <p>El nombre de la zona ser\u00e1 <code>&lt;direcci\u00f3n de red inversa sin los octetos de host&gt;.in-addr.arpa</code>. Aparte de esto, el proceso es igual al de crear una zona normal.</p> <p></p>"},{"location":"#archivo-de-zona-inversa","title":"Archivo de zona inversa","text":"<p>A\u00f1adimos los registros correspondientes SOA, NS y un nuevo registro de tipo PTR.</p> <p>El registro PTR es el opuesto al registro A, ya que en lugar de vincular un nombre de dominio a una direcci\u00f3n IP, asocia una direcci\u00f3n IP con un nombre de dominio. La diferencia principal es que la direcci\u00f3n IP se invierte. Por ejemplo, si la IP es 192.168.1.10, en el registro PTR se escribe como 10.1.168.192. Adem\u00e1s, como la zona se llama 1.168.192.in-addr.arpa (en mi caso), solo necesitamos colocar la parte de la direcci\u00f3n que corresponde al host, es decir, 10, sin tener que escribir toda la IP completa.</p> <p></p>"},{"location":"#comprobacion-del-funcionamiento-del-dns","title":"Comprobaci\u00f3n del funcionamiento del DNS","text":"<p>Comprobamos configuraci\u00f3n</p> <p>Para comprobar que todo funciona correctamente tenemos que ejecutar los dos siguientes comandos, fij\u00e1ndonos si en las salidas de estos nos devuelven un OK.</p> <p></p> <p>Una vez tenemos OK en las dos zonas, podemos reiniciar el servicio de Bind9 para aplicar los cambios, esto se hace con el siguiente comando:</p> <pre><code>    sudo systemctl restart named\n</code></pre> <p></p>"},{"location":"#comprobamos-las-resoluciones-de-nombre-con-dig","title":"Comprobamos las resoluciones de nombre con dig","text":"<p>Para comprobar que todo funciona correctamente primeramente debemos de configurar nuestro sistema para a\u00f1adir el servidor DNS para que pregunte a este adem\u00e1s del por defecto, en mi caso con Debian ser\u00eda en la configuraci\u00f3n de la red conectada.</p> <p></p> <p>Ahora para ver si nos resuelve correctamente el nombre, debemos de usar el comando:</p> <pre><code>    dig &lt;subdominio o dominio&gt;\n</code></pre> <p></p> <p>Ahora para ver si nos resuelve correctamente el nombre, debemos de usar el comando:</p> <pre><code> dig -x &lt;ip&gt;\n</code></pre> <p></p>"},{"location":"#cuestiones","title":"Cuestiones","text":""},{"location":"#cuestion-1","title":"Cuesti\u00f3n 1:","text":"<p>\u00bfQu\u00e9 pasar\u00e1 si un cliente de una red diferente a la tuya intenta hacer uso de tu DNS de alguna manera, le funcionar\u00e1?\u00bfPor qu\u00e9, en qu\u00e9 parte de la configuraci\u00f3n puede verse?</p> <p>Si un cliente de una red diferente intenta usar el DNS de otra red, normalmente no funcionar\u00e1. Esto ocurre porque el servidor DNS esta configurado para responder solo a las peticiones que vienen de su propia red.</p>"},{"location":"#cuestion-2","title":"Cuesti\u00f3n 2:","text":"<p>\u00bfPor qu\u00e9 tenemos que permitir las consultas recursivas en la configuraci\u00f3n?</p> <p>Las consultas recursivas se permiten en la configuraci\u00f3n de un servidor DNS porque simplifican y optimizan el proceso de resoluci\u00f3n de nombres para los clientes. </p>"},{"location":"#cuestion-3","title":"Cuesti\u00f3n 3:","text":"<p>El servidor DNS que acab\u00e1is de montar, \u00bfes autoritativo? \u00bfPor qu\u00e9?</p> <p>El servidor DNS que se ha montado puede considerarse autoritativo porque act\u00faa como la fuente definitiva de informaci\u00f3n para los dominios que gestiona.</p>"},{"location":"#cuestion-4","title":"Cuesti\u00f3n 4:","text":"<p>\u00bfD\u00f3nde podemos encontrar la directiva $ORIGIN y para qu\u00e9 sirve?</p> <p>La directiva $ORIGIN se encuentra en los ficheros de zona DNS y sirve para definir el dominio base que se a\u00f1adir\u00e1 autom\u00e1ticamente a los nombres incompletos en los registros de recursos.</p>"},{"location":"#cuestion-5","title":"Cuesti\u00f3n 5:","text":"<p>\u00bfUna zona es id\u00e9ntico a un dominio?</p> <p>Un dominio es un nombre completo en la jerarqu\u00eda DNS, como \"daw.com\", mientras que una zona es una porci\u00f3n del espacio de nombres DNS que est\u00e1 bajo el control administrativo de una entidad espec\u00edfica</p>"},{"location":"#cuestion-6","title":"Cuesti\u00f3n 6:","text":"<p>\u00bfPueden editarse los archivos de zona de un servidor esclavo/secundario?</p> <p>Los archivos de zona de un servidor DNS esclavo o secundario no pueden editarse directamente. Estos archivos se generan autom\u00e1ticamente mediante transferencias de zona desde el servidor primario y son de solo lectura en el servidor secundario.</p>"},{"location":"#cuestion-7","title":"Cuesti\u00f3n 7:","text":"<p>\u00bfPor qu\u00e9 podr\u00eda querer tener m\u00e1s de un servidor esclavo para una misma zona?</p> <p>Tener m\u00faltiples servidores esclavos para una misma zona DNS es una estrategia crucial para garantizar la disponibilidad continua del servicio DNS. Si por ejemplo falla un servidor, los otros servidores seguiran respondiendo a las consultas.</p>"},{"location":"#cuestion-8","title":"Cuesti\u00f3n 8:","text":"<p>\u00bfCu\u00e1ntos servidores ra\u00edz existen?</p> <p>Existen 13 identificadores de servidores ra\u00edz (RSI) en el sistema DNS, pero el n\u00famero real de servidores f\u00edsicos es mucho mayor</p>"},{"location":"#cuestion-9","title":"Cuesti\u00f3n 9:","text":"<p>\u00bfQu\u00e9 es una consulta iterativa de referencia?</p>"},{"location":"#cuestion-10","title":"Cuesti\u00f3n 10:","text":"<p>Al que le indiquemos en el registro PTR de la zona DNS inversa.</p>"}]}